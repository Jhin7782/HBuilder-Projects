<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/reset.css" />
		<link rel="stylesheet" type="text/css" href="css/media.css" />
		<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/fontsize.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/adjust.js" type="text/javascript" charset="utf-8"></script>

		<style type="text/css">
			#p1_bg {
				/*background-image: url(img/p1/p1_bg_640_1136.png);
				background-size: 100% 100%;*/
				width: 16rem;
				/*height: 28.4rem;*/
				position: relative;
			}
			#enter {
				background: transparent;
				background-image: url(img/p1/p1_btn_263_85.png);
				background-size: 100% 100%;
				position: absolute;
				left: 4.7125rem;
				bottom: 1rem;
				width: 6.575rem;
				height: 2.125rem;
			}
		
			#demo {
				background-color: lightgreen;
				width: 16rem;
				/*height: 19rem;*/
				overflow: hidden;
				position: relative;
				display: none;
			}
			
			#demo1 {
				position: absolute;
				bottom: 0rem;
				left: 0rem;
				/*-webkit-transition: bottom 0.3s ease;*/
			}
			
			#time_counter {
				position: absolute;
				
			}
			
			#player_left {
				width: 1.8rem;
				height: 3.6rem;
				position: absolute;
				left: 7.1rem;
				bottom: 4.9rem;
				/*border: 0.0625rem solid palevioletred;
				width: 2rem;
				height: 3rem;
				text-align: center;
				line-height: 3rem;
				color: seagreen;
				left: 7rem;
				bottom: 8rem;*/
			}
			#player_right {
				width: 1.8rem;
				height: 3.6rem;
				position: absolute;
				left: 7.1rem;
				bottom: 4.9rem;
				display: none;
			}
			
			#player_gogo {
				width: 2.425rem;
				height: 4.475rem;
				position: absolute;
				left: 6.7875rem;
				bottom: 3.95rem;
				display: none;
			}
			
			#btns {
				/*background-color: sandybrown;*/
				text-align: center;
				position: absolute;
				left: 1.5rem;
				bottom: 1rem;
			}
			
			#btn_left {
				position: absolute;
				left: 1rem;
				bottom: 0.5rem;
				width: 3.125rem;
				height: 3.2rem;
				background-image: url(img/p2/btn_left_125_128.png);
				background-size: 100% 100%;
				border-radius: 1.6rem;
				margin-right: 6.8rem;
				/*rotation: 90deg;*/
				transform: rotate("90deg");
			}
			
			#btn_right {
				position: absolute;
				right: 1rem;
				bottom: 0.5rem;
				width: 3.125rem;
				height: 3.2rem;
				background-image: url(img/p2/btn_right_125_128.png);
				background-size: 100% 100%;
				border-radius: 1.6rem;
			}
			
			#gogo {
				position: absolute;
				left: 6.025rem;
				bottom: 1.5rem;
				width: 3.95rem;
				height: 1.025rem;
				background-image: url(img/p2/gogo.png);
				background-size: 100% 100%;
				/*border-radius: 0.2rem;*/
			}
			#gogo_active {
				position: absolute;
				left: 6.025rem;
				bottom: 1.5rem;
				width: 3.95rem;
				height: 1.025rem;
				background-image: url(img/p2/gogo_active.png);
				background-size: 100% 100%;
				/*border-radius: 0.2rem;*/
				display: none;
			}
			
			#mc_play {
				background-image: url(img/p2/mcbg.png);
				width: 1.4rem;
				height: 1.4rem;
				position: fixed;
				right: 0.5rem;
				top: 0.5rem;
				animation: reverseRotataZ 4s linear infinite normal;
				-webkit-animation: reverseRotataZ 4s linear infinite normal;
				animation: rotataZ 4s linear infinite normal;
				-webkit-animation: rotataZ 4s linear infinite normal;
			}
			
			@-webkit-keyframes reverseRotataZ {
				0% {
					-webkit-transform: rotateZ(0deg);
				}
				100% {
					-webkit-transform: rotateZ(-360deg);
				}
			}
			
			@-webkit-keyframes rotataZ {
				0% {
					-webkit-transform: rotateZ(0deg);
				}
				100% {
					-webkit-transform: rotateZ(360deg);
				}
			}
		</style>
	</head>

	<body>
		<div id="p1">
			<img id="p1_bg" src="img/p1/p1_bg_640_963.png"/>
			<input type="button" name="enter" id="enter" value="" onclick="enter()" />
		</div>
		
		<div id=demo>
			<div id=demo1>
				<img src="img/p2/bg_640_5019_finalline.png" />
			</div>
			
			<span id="time_counter">0</span>
			
			<img id="player_left" src="img/p2/player_left.png" />
			<img id="player_right" src="img/p2/player_right.png"/>
			<img id="player_gogo" src="img/p2/player_gogo.gif"/>

			<input type="button" name="" id="btn_left" value="" />
			<input type="button" name="" id="btn_right" value="" />
			<img id="gogo" src="img/p2/gogo.png" onclick="on()"/>
			<img id="gogo_active" src="img/p2/gogo_active.png" onclick="off()"/>

			<span id="musicControl">
        		<a id="mc_play" class="stop" onclick="play_music();">
            		<audio id="musicfx" loop="loop" autoplay="autoplay" preload="auto">
               			<source src="raw/rather_be.mp3" type="audio/mpeg">
           			 </audio>
       			 </a>
 			</span>
		</div>

		<script type="text/javascript">
			var demo = document.getElementById("demo");
			var demo1 = document.getElementById("demo1");
			
			var player_left = document.getElementById("player_left");
			var palyer_right = document.getElementById("player_right");
			var player_gogo = document.getElementById("player_gogo");
			
			var btn_left = document.getElementById("btn_left");
			var btn_right = document.getElementById("btn_right");
			var gogo = document.getElementById("gogo");
			var gogo_active = document.getElementById("gogo_active");
			
			var per1 = 0;
			var player_pos = 4.9;
			var count = 0;
			
			btn_left.addEventListener("touchstart", handleStart1, false);
			btn_right.addEventListener("touchstart", handleStart2, false);

			function handleStart1(evt) {
				evt.preventDefault(); //阻止事件的默认行为
				per1 -= 0.525;
//				alert(demo.scrollTop+"  "+demo1.scrollTop+"  "+demo.offsetHeight+"  "+demo1.offsetHeight+"  "+demo.offsetTop+"  "+demo1.offsetTop);
				
				count += 1;
				if(demo1.offsetTop < -20 && count == 1){
					demo1.style.bottom = per1 + "rem";
				}
				if (demo1.offsetTop >= -20) {
					player_pos += 0.525;
					player_left.style.bottom = player_pos + "rem";
				}
				
				$("#player_gogo").hide();
				$("#player_left").hide();
				$("#player_right").show();
				
				$("#gogo_active").hide();
				$("#gogo").show();
				window.clearInterval(autogo);
				
				
//				setInterval(function() {
//					var nowtime = $("#time_counter").html();	
////					alert(nowtime);
//				}, 2000);
				
				
			}
			function handleStart2(evt) {
				evt.preventDefault(); //阻止事件的默认行为
				per1 -= 0.525;
//				alert(demo.scrollTop+"  "+demo1.scrollTop+"  "+demo.offsetHeight+"  "+demo1.offsetHeight+"  "+demo.offsetTop+"  "+demo1.offsetTop);
				
				
				//计数器归零
				count = 0;				
				if(demo1.offsetTop < -20 && count == 1){
					demo1.style.bottom = per1 + "rem";
				}
				if (demo1.offsetTop >= -20) {
					player_pos += 0.525;
					player_right.style.bottom = player_pos + "rem";
				}

				$("#player_gogo").hide();
				$("#player_left").show();
				$("#player_right").hide();
				window.clearInterval(autogo);
			}
			
			
			var client_height = document.documentElement.clientHeight;
			//alert(client_height);
			demo.style.height = client_height / 40 + "rem";

			function play_music() {
				if ($('#mc_play').hasClass('on')) {
					$('#mc_play audio').get(0).pause();
					$('#mc_play').attr('class', 'stop');
				} else {
					$('#mc_play audio').get(0).play();
					$('#mc_play').attr('class', 'on');
				}
				$('#music_play_filter').hide();
				event.stopPropagation(); //阻止冒泡 
			}
			
			
			function enter () {
				$("#p1").hide();
				$("#demo").show();
			}
			
			var autogo;
			var time_interval;
			function on () {
				$("#gogo_active").show();
				$("#player_left").hide();
				$("#player_right").hide();
				$("#player_gogo").show();
				autogo = setInterval(function() {
					per1 -= 0.525;
					if(demo1.offsetTop < -20){
						demo1.style.bottom = per1 + "rem";
					}
					
					if (demo1.offsetTop >= -20) {
						if (player_pos < 16.5) {
							player_pos += 0.525;
							player_gogo.style.bottom = player_pos + "rem";
						} else {
							off();
							player_left.style.bottom = player_pos+0.9 + "rem";
							clearInterval(time_interval);
						}
//						if (player_pos = 29.5) {
//							//alert("14.5");
//							//console.log("19.5");
//						}
					}
				}, 40);
				
				time_interval = setInterval(function() {
					var nowtime = $("#time_counter").html();
					var nowtime_float = parseInt(nowtime);
					nowtime_float += 1;
					$("#time_counter").html(nowtime_float);
				}, 1000);
			}
			function off () {
				$("#gogo_active").hide();
				$("#player_gogo").hide();
				player_left.style.bottom = player_pos + "rem";
				$("#player_left").show();
				window.clearInterval(autogo);
			}
			
		</script>
	</body>

</html>